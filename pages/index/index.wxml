<!-- é¦–é¡µ -->
<view class="container home-container fade-in">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="header card">
    <view class="header-content">
      <view class="avatar-container">
        <image wx:if="{{avatarUrl}}" class="avatar" src="{{avatarUrl}}" mode="aspectFill"></image>
        <view wx:else class="avatar default-avatar">
          <text class="avatar-text">{{nickname.charAt(0)}}</text>
        </view>
      </view>
      <view class="user-info">
        <text class="nickname title-medium">{{nickname}}</text>
        <text class="welcome-text text-secondary">æ¬¢è¿æ¥åˆ°éº»å°†è®°åˆ†</text>
      </view>
    </view>
    <view class="header-decoration">
      <text class="mahjong-emoji">ğŸ€«</text>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œåŒºåŸŸ -->
  <view class="quick-actions">
    <view class="action-card card" bindtap="goInvite">
      <view class="action-icon primary-bg">
        <text class="icon-text">ğŸ®</text>
      </view>
      <view class="action-content">
        <text class="action-title title-small">å¼€å§‹è®¡åˆ†</text>
        <text class="action-desc text-secondary">é‚€è¯·å¥½å‹å‚ä¸è®¡åˆ†</text>
      </view>
      <view class="action-arrow">
        <text class="arrow-text">â€º</text>
      </view>
    </view>

    <view class="action-card card" bindtap="goRecords">
      <view class="action-icon secondary-bg">
        <text class="icon-text">ğŸ“Š</text>
      </view>
      <view class="action-content">
        <text class="action-title title-small">å†å²è®°å½•</text>
        <text class="action-desc text-secondary">æŸ¥çœ‹å¾€æœŸå¯¹å±€</text>
      </view>
      <view class="action-arrow">
        <text class="arrow-text">â€º</text>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ¦‚è§ˆå¡ç‰‡ -->
  <view class="stats-overview card">
    <view class="stats-header">
      <text class="stats-title title-medium">æœ¬æœˆç»Ÿè®¡</text>
      <text class="stats-period text-secondary">{{currentMonth}}</text>
    </view>
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number text-primary">{{monthStats.totalGames}}</text>
        <text class="stat-label text-secondary">æ€»åœºæ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-number text-success">{{monthStats.winRate}}%</text>
        <text class="stat-label text-secondary">èƒœç‡</text>
      </view>
      <view class="stat-item">
        <text class="stat-number {{monthStats.totalScore >= 0 ? 'text-success' : 'text-danger'}}">{{monthStats.totalScore}}</text>
        <text class="stat-label text-secondary">æ€»å¾—åˆ†</text>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘å¯¹å±€ -->
  <view class="recent-games card" wx:if="{{recentGames.length > 0}}">
    <view class="section-header">
      <text class="section-title title-medium">æœ€è¿‘å¯¹å±€</text>
      <text class="more-link text-secondary" bindtap="goRecords">æŸ¥çœ‹æ›´å¤š â€º</text>
    </view>
    <view class="games-list">
      <block wx:for="{{recentGames}}" wx:key="id" wx:for-item="game">
        <view class="game-item" data-id="{{game.id}}" bindtap="viewGameDetail">
          <!-- ç©å®¶å¤´åƒå’Œåˆ†æ•° -->
          <view class="players-row">
            <block wx:for="{{game.playersList}}" wx:key="name" wx:for-item="player">
              <view class="player">
                <view class="player-avatar" style="background-color: {{player.avatarColor}}">
                  <text class="avatar-text">{{player.name === 'å°' ? 'å°' : player.name.charAt(0)}}</text>
                </view>
                <text class="player-name">{{player.name}}</text>
                <text class="player-score {{player.score >= 0 ? 'positive' : 'negative'}}">
                  {{player.score}}
                </text>
              </view>
            </block>
          </view>
          
          <!-- æ—¥æœŸæ—¶é—´å’Œå±€æ•°ã€çŠ¶æ€ -->
          <view class="game-footer">
            <view class="footer-left">
              <text class="game-date">{{game.date}}</text>
              <text class="status-text {{game.status === 'ongoing' ? 'status-ongoing' : 'status-finished'}}" style="height: -22rpx; display: block; box-sizing: border-box">
                {{game.status === 'ongoing' ? 'è¿›è¡Œä¸­' : 'å·²ç»“æŸ'}}
              </text>
            </view>
            <text class="game-rounds" wx:if="{{game.roundsCount > 0}}">{{game.roundsCount}}å±€</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ - å½“æ²¡æœ‰æœ€è¿‘å¯¹å±€æ—¶æ˜¾ç¤º -->
  <view class="empty-games card" wx:else>
    <view class="empty-state">
      <text class="icon">ğŸ€«</text>
      <text class="title">ç­‰é£æ¥ä¸å¦‚æ¥å¼€å±€</text>
      <text class="desc">ç‚¹å‡»ä¸Šæ–¹"å¼€å§‹è®¡åˆ†"åˆ›å»ºé¦–å±€</text>
    </view>
  </view>
</view>