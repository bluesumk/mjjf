<!-- pages/session/join/index.wxml -->
<view class="container join-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-state">
    <view class="loading-spinner"></view>
    <text class="loading-text">æ­£åœ¨åŠ è½½ç‰Œå±€ä¿¡æ¯...</text>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view wx:elif="{{error}}" class="error-state">
    <view class="error-icon">âŒ</view>
    <text class="error-title">æ— æ³•åŠ å…¥ç‰Œå±€</text>
    <text class="error-message">{{error}}</text>
    <view class="error-actions">
      <button type="default" class="retry-btn" bindtap="refresh">é‡è¯•</button>
      <button type="primary" class="home-btn" bindtap="goHome">å›åˆ°é¦–é¡µ</button>
    </view>
  </view>

  <!-- æˆåŠŸçŠ¶æ€ -->
  <view wx:else class="success-state">
    <view class="session-info card">
      <view class="session-header">
        <text class="session-title">ğŸ® ç‰Œå±€é‚€è¯·</text>
        <text class="session-status {{session.status === 'ongoing' ? 'ongoing' : 'pending'}}">
          {{session.status === 'ongoing' ? 'è¿›è¡Œä¸­' : 'ç­‰å¾…å¼€å§‹'}}
        </text>
      </view>
      
      <view class="session-details">
        <view class="detail-item">
          <text class="detail-label">å‚ä¸è€…ï¼š</text>
          <text class="detail-value">{{session.participants.length}}äºº</text>
        </view>
        
        <view class="detail-item">
          <text class="detail-label">åˆ›å»ºæ—¶é—´ï¼š</text>
          <text class="detail-value">{{session.createdAt}}</text>
        </view>
        
        <view wx:if="{{session.taiSwitch}}" class="detail-item">
          <text class="detail-label">å°æ¿ï¼š</text>
          <text class="detail-value enabled">å·²å¯ç”¨</text>
        </view>
      </view>
      
      <!-- å‚ä¸è€…åˆ—è¡¨ -->
      <view class="participants-section">
        <text class="section-title">å‚ä¸è€…åˆ—è¡¨</text>
        <view class="participants-list">
          <view wx:for="{{session.participants}}" wx:key="index" class="participant-item">
            <view class="participant-avatar">
              <text class="avatar-text">{{item.charAt(0)}}</text>
            </view>
            <text class="participant-name">{{item}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="join-actions">
      <button type="primary" 
              class="join-btn" 
              bindtap="joinSession" 
              disabled="{{joining}}"
              loading="{{joining}}">
        {{joining ? 'åŠ å…¥ä¸­...' : 'åŠ å…¥ç‰Œå±€'}}
      </button>
      
      <button type="default" class="cancel-btn" bindtap="goHome">
        å–æ¶ˆ
      </button>
    </view>
  </view>
</view>
